<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="https://openlayers.org/en/v4.6.5/css/ol.css" type="text/css">
  <link rel="stylesheet" href="css/demo.css" type="text/css">
</head>
<body>
<div id="map">
  <input id="swipe" type="range" style="width: 100%">
</div>
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script src="https://openlayers.org/en/v4.6.5/build/ol.js"></script>
<script src="js/demo.js"></script>
<script src="js/proj.js"></script>
<script>
  /**
   这是船讯网“地图API”功能开发介绍。 
       API介绍地址：http://api.shipxy.com/
       H5版地图典型应用地址：http://api.shipxy.com/h5/sample/
       H5版地图开发示例地址：http://api.shipxy.com/h5/demo/#a1_0
       H5版地图开发文档地址：http://api.shipxy.com/h5/api/3.0doc/ShipxyAPI.html
   ea144475022d4fb1a2c2a94dfa6bb88f/111111
   * /
  var base = getTileSea();
  var base2 = getTilelayer();
  var untiled = new ol.layer.Image({
    source: new ol.source.ImageWMS({
      ratio: 1,
      url: 'http://39.106.122.204:8086/geoserver/world/wms',
      params: {
        'FORMAT': 'image/png',
        'VERSION': '1.1.1',
        LAYERS: 'world:layer_boundry',
      }
    })
  });
  var map = new ol.Map({
    controls: ol.control.defaults({
      attribution: false
    }),
    target: 'map',
    layers: [base, base2, untiled],
    view: new ol.View({
      center: ol.proj.fromLonLat([98.633, 31.607]),
      zoom:4,
      minZoom:0,
      maxZoom:18
    })
  });

  var swipe = document.getElementById('swipe');
  base2.on('precompose', function(event) {
    var ctx = event.context;
    var width = ctx.canvas.width * (swipe.value / 100);

    ctx.save();
    ctx.beginPath();
    ctx.rect(width, 0, ctx.canvas.width - width, ctx.canvas.height);
    ctx.clip();
  });
  base2.on('postcompose', function(event) {
    var ctx = event.context;
    ctx.restore();
  });
  swipe.addEventListener('input', function() {
    map.render();
  }, false);

  var features = [];
  var coord84= ol.proj.fromLonLat([124.97440000000003, 37.19788846500339]),
    coord2000 = ol.proj.fromLonLat([124.97440000000005, 37.38331086007506]);
  var coord_wgs = [124.96910961071603, 37.19717839124166];
  var coord3 = coordtransform.wgs84togcj02(124.97969038928403, 37.19859853876512);
  /**
   *
   *
   * 124.96910961071603
   1: 37.19717839124166
   */
  console.log(coord3);
  features.push(
    new ol.Feature({
      geometry: new ol.geom.Point(
        coord2000
      ),
      type: 'm'
    })
  );
  features.push(
    new ol.Feature({
      geometry: new ol.geom.Point(
        coord84
      ),
      type: 'wmap'
    })
  );
  
  var dis = (coord2000[0] - coord84[0])*(coord2000[0] - coord84[0]) + (coord2000[1] - coord84[1]) * (coord2000[1] - coord84[1]);
  console.log(Math.sqrt( dis ));
  var source = new ol.source.Vector({
    features: features
  });
  var vector = new ol.layer.Vector({
    source: source,
    style: function (feat) {
      const color = feat.get('type') === 'm' ? '#2E8B57' : '#c40403';
      return new ol.style.Style({
        image: new ol.style.Circle({
          radius: 3,
          fill: new ol.style.Fill({
            color: color
          })
        })
      })
    }
  });
  map.addLayer(vector);
</script>
</body>
</html>
